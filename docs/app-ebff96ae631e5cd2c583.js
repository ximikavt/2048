webpackJsonp([0],[,,,,function(e,t,i){"use strict";var n=i(3);i(2),i(1),i(0);var r=i(19);i(8);var o=i(11),s=i(12),a=i(14),l=i(18),u=i(15),c=i(13),h=i(16),f=i(17);t.app="app",t.__esModule=!0,t.default=n.module(t.app,["ui.router","ngCookies","ngAnimate"]).config(r.default).directive("grid",h.default).directive("tile",f.default).service("GameManager",s.default).service("GridService",a.default).service("KeyboardService",l.default).factory("TileModel",u.default).factory("GenerateUniqueId",c.default).controller("MainAppController",o.default)},,,,function(e,t){},function(e,t){e.exports="app/views/grid.tpl.html"},function(e,t){e.exports="app/views/tile.tpl.html"},function(e,t){"use strict";var i=function(){function e(e,t,i,n){var r=this;this.GameManager=e,this.KeyboardService=t,this.GridService=i,this.$scope=n,this.game=this.GameManager,this.gs=this.GridService,this.newGame=function(){r.KeyboardService.init(),r.game.newGame(),r.startGame()},this.startGame=function(){r.KeyboardService.on(function(e){r.game.move(e),r.$scope.$apply()})},this.newGame()}return e}();t.__esModule=!0,t.default=i},function(e,t){"use strict";var i=function(){function e(e,t,i){var n=this;this.GridService=e,this.$cookieStore=t,this.$q=i,this.currentScore=0,this.highScore=0,this.winningValue=2048,this.getHighScore=function(){return parseInt(n.$cookieStore.get("highScore"))||0},this.newGame=function(){n.GridService.buildEmptyGameBoard(),n.GridService.buildStartingPosition(),n.reinit()},this.reinit=function(){n.gameOver=!1,n.win=!1,n.currentScore=0,n.highScore=n.getHighScore()},this.move=function(e){var t=function(){if(n.win)return!1;var t=n.GridService.traversalDirections(e),i=!1,r=!1;n.GridService.prepareTiles(),t.x.forEach(function(o){t.y.forEach(function(t){var s={x:o,y:t},a=n.GridService.getCellAt(s);if(a){var l=n.GridService.calculateNextPosition(a,e),u=l.next;if(u&&u.value===a.value&&!u.merged){var c=2*a.value,h=n.GridService.newTile(a,c);h.merged=[a,l.next],n.GridService.insertTile(h),n.GridService.removeTile(a),n.GridService.moveTile(h,u),n.updateScore(n.currentScore+l.next.value),h.value>=n.winningValue&&(r=!0),i=!0}else n.GridService.moveTile(a,l.newPosition);n.GridService.samePositions(s,l.newPosition)||(i=!0)}})}),r&&!n.win&&(n.win=!0),i&&(n.GridService.randomlyInsertNewTile(),!n.win&&n.movesAvailable()||(n.gameOver=!0))};return n.$q.when(t())},this.updateScore=function(e){console.log(e),n.currentScore=e,n.currentScore>n.getHighScore()&&(n.highScore=e,n.$cookieStore.put("highScore",e))},this.movesAvailable=function(){return n.GridService.anyCellsAvailable()||n.GridService.tileMatchesAvailable()}}return e}();t.__esModule=!0,t.default=i},function(e,t){"use strict";function i(){var e=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:7&i|8).toString(16)});return t};return{next:function(){return e()}}}t.__esModule=!0,t.default=i},function(e,t){"use strict";var i=function(){function e(e){var t=this;this.TileModel=e,this.grid=[],this.tiles=[],this.size=4,this.startingTileNumber=2,this.buildStartingPosition=function(){for(var e=0;e<t.startingTileNumber;e++)t.randomlyInsertNewTile()},this.availableCells=function(){var e=[];return t.forEach(function(i,n){var r=t.getCellAt({x:i,y:n});r||e.push({x:i,y:n})}),e},this.getSize=function(){return this.size},this.randomlyInsertNewTile=function(){var e=t.randomAvailableCell(),i=new t.TileModel(e,2);t.insertTile(i)},this.insertTile=function(e){var i=t._coordinatesToPosition(e);t.tiles[i]=e},this.removeTile=function(e){var i=t._coordinatesToPosition(e);delete t.tiles[i]},this.randomAvailableCell=function(){var e=t.availableCells();if(e.length>0)return e[Math.floor(Math.random()*e.length)]},this.buildEmptyGameBoard=function(){for(var e=0;e<t.size*t.size;e++)t.grid[e]=void 0;t.forEach(function(e,i){t.setCellAt({x:e,y:i},void 0)})},this.forEach=function(e){for(var i=t.size*t.size,n=0;n<i;n++){var r=t._positionToCoordinates(n);e(r.x,r.y,t.tiles[n])}},this.setCellAt=function(e,i){if(t.withinGrid(e)){var n=t._coordinatesToPosition(e);t.tiles[n]=i}},this.getCellAt=function(e){if(t.withinGrid(e)){var i=t._coordinatesToPosition(e);return t.tiles[i]}},this.prepareTiles=function(){t.forEach(function(e,t,i){i&&i.reset()})},this.calculateNextPosition=function(e,i){var n,r=t.vectors[i];do n=e,e={x:n.x+r.x,y:n.y+r.y};while(t.withinGrid(e)&&t.cellAvailable(e));return{newPosition:n,next:t.getCellAt(e)}},this.cellAvailable=function(e){return t.withinGrid(e)?!t.getCellAt(e):void 0},this.newTile=function(e,i){return new t.TileModel(e,i)},this.moveTile=function(e,i){var n={x:e.x,y:e.y};t.setCellAt(n,void 0),t.setCellAt(i,e),e.updatePosition(i)},this.withinGrid=function(e){return e.x>=0&&e.x<t.size&&e.y>=0&&e.y<t.size},this._positionToCoordinates=function(e){var i=e%t.size,n=(e-i)/t.size;return{x:i,y:n}},this.vectors={left:{x:-1,y:0},right:{x:1,y:0},up:{x:0,y:-1},down:{x:0,y:1}},this.samePositions=function(e,t){return e.x===t.x&&e.y===t.y},this.anyCellsAvailable=function(){return t.availableCells().length>0},this.traversalDirections=function(e){for(var i=t.vectors[e],n={x:[],y:[]},r=0;r<t.size;r++)n.x.push(r),n.y.push(r);return i.x>0&&(n.x=n.x.reverse()),i.y>0&&(n.y=n.y.reverse()),n},this.tileMatchesAvailable=function(){for(var e=t.size*t.size,i=0;i<e;i++){var n=t._positionToCoordinates(i),r=t.tiles[i];if(r)for(var o in t.vectors){var s=t.vectors[o],a={x:n.x+s.x,y:n.y+s.y},l=t.getCellAt(a);if(l&&l.value===r.value)return!0}}return!1},this._coordinatesToPosition=function(e){return e.y*t.size+e.x}}return e}();t.__esModule=!0,t.default=i},function(e,t){"use strict";var i=function(){function e(e){var t=function(t,i){this.x=t.x,this.y=t.y,this.value=i||2,this.id=e.next(),this.merged=null};return t.prototype.savePosition=function(){this.originalX=this.x,this.originalY=this.y},t.prototype.reset=function(){this.merged=null},t.prototype.setMergedBy=function(e){var t=this;e.forEach(function(e){e.merged=!0,e.updatePosition(t.getPosition())})},t.prototype.updateValue=function(e){this.value=e},t.prototype.updatePosition=function(e){this.x=e.x,this.y=e.y},t.prototype.getPosition=function(){return{x:this.x,y:this.y}},t}return e}();t.__esModule=!0,t.default=i},function(e,t,i){"use strict";function n(){return{restrict:"A",scope:{model:"="},templateUrl:r,link:function(e){e.$watch(function(){return e.model},function(e){console.log(e)})}}}var r=i(9);t.__esModule=!0,t.default=n},function(e,t,i){"use strict";function n(){return{restrict:"A",scope:{model:"="},templateUrl:r,link:function(e){}}}var r=i(10);t.__esModule=!0,t.default=n},function(e,t){"use strict";var i=function(){function e(e){var t=this;this.$document=e,this.UP="up",this.RIGHT="right",this.DOWN="down",this.LEFT="left",this.keyEventHandlers=[],this.keyboardMap={37:this.LEFT,38:this.UP,39:this.RIGHT,40:this.DOWN},this.init=function(){t.$document.bind("keydown",function(e){var i=t.keyboardMap[e.which];i&&(e.preventDefault(),t._handleKeyEvent(i,e))})},this._handleKeyEvent=function(e,i){var n=t.keyEventHandlers;if(n&&(i.preventDefault(),n))for(var r=0;r<n.length;r++){var o=n[r];o(e,i)}},this.on=function(e){t.keyEventHandlers.push(e)}}return e}();t.__esModule=!0,t.default=i},function(e,t){"use strict";function i(e,t,i){i.html5Mode(!0).hashPrefix("!"),t.otherwise("/"),e.state("app",{url:"/",templateUrl:"app/views/main.tpl.html"})}i.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],t.__esModule=!0,t.default=i},function(e,t,i){"use strict";i(4)}],[20]);